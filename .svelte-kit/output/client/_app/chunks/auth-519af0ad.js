function q(a){return new Uint8Array(a)}function rf(a){return new Int32Array(a)}function Af(a){return new Float64Array(a)}function Kf(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];for(var r=0,f=a;r<f.length;r++){var x=f[r];if(!(x instanceof Uint8Array))throw new TypeError("unexpected type, use ByteArray")}}var bf=1<<16;function kf(a,e){for(var r=0;r<e;r+=bf)crypto.getRandomValues(a.subarray(r,r+Math.min(e-r,bf)))}function s(a){var e=Af(16);if(a)for(var r=0;r<a.length;r++)e[r]=a[r];return e}var pf=q(32);pf[0]=9;var of=s(),tf=s([1]);s([56129,1]);s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]);var _f=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),df=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),nf=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function af(a,e,r){for(var f=0;f<16;f++)a[f]=e[f]+r[f]}function ef(a,e,r){for(var f=0;f<16;f++)a[f]=e[f]-r[f]}function J(a,e,r){var f,x,u=0,y=0,P=0,V=0,C=0,D=0,Y=0,X=0,N=0,O=0,F=0,E=0,K=0,_=0,k=0,p=0,H=0,v=0,M=0,A=0,l=0,c=0,t=0,d=0,b=0,o=0,n=0,R=0,L=0,W=0,ff=0,i=r[0],S=r[1],T=r[2],U=r[3],g=r[4],h=r[5],I=r[6],z=r[7],w=r[8],j=r[9],B=r[10],m=r[11],Q=r[12],Z=r[13],$=r[14],G=r[15];f=e[0],u+=f*i,y+=f*S,P+=f*T,V+=f*U,C+=f*g,D+=f*h,Y+=f*I,X+=f*z,N+=f*w,O+=f*j,F+=f*B,E+=f*m,K+=f*Q,_+=f*Z,k+=f*$,p+=f*G,f=e[1],y+=f*i,P+=f*S,V+=f*T,C+=f*U,D+=f*g,Y+=f*h,X+=f*I,N+=f*z,O+=f*w,F+=f*j,E+=f*B,K+=f*m,_+=f*Q,k+=f*Z,p+=f*$,H+=f*G,f=e[2],P+=f*i,V+=f*S,C+=f*T,D+=f*U,Y+=f*g,X+=f*h,N+=f*I,O+=f*z,F+=f*w,E+=f*j,K+=f*B,_+=f*m,k+=f*Q,p+=f*Z,H+=f*$,v+=f*G,f=e[3],V+=f*i,C+=f*S,D+=f*T,Y+=f*U,X+=f*g,N+=f*h,O+=f*I,F+=f*z,E+=f*w,K+=f*j,_+=f*B,k+=f*m,p+=f*Q,H+=f*Z,v+=f*$,M+=f*G,f=e[4],C+=f*i,D+=f*S,Y+=f*T,X+=f*U,N+=f*g,O+=f*h,F+=f*I,E+=f*z,K+=f*w,_+=f*j,k+=f*B,p+=f*m,H+=f*Q,v+=f*Z,M+=f*$,A+=f*G,f=e[5],D+=f*i,Y+=f*S,X+=f*T,N+=f*U,O+=f*g,F+=f*h,E+=f*I,K+=f*z,_+=f*w,k+=f*j,p+=f*B,H+=f*m,v+=f*Q,M+=f*Z,A+=f*$,l+=f*G,f=e[6],Y+=f*i,X+=f*S,N+=f*T,O+=f*U,F+=f*g,E+=f*h,K+=f*I,_+=f*z,k+=f*w,p+=f*j,H+=f*B,v+=f*m,M+=f*Q,A+=f*Z,l+=f*$,c+=f*G,f=e[7],X+=f*i,N+=f*S,O+=f*T,F+=f*U,E+=f*g,K+=f*h,_+=f*I,k+=f*z,p+=f*w,H+=f*j,v+=f*B,M+=f*m,A+=f*Q,l+=f*Z,c+=f*$,t+=f*G,f=e[8],N+=f*i,O+=f*S,F+=f*T,E+=f*U,K+=f*g,_+=f*h,k+=f*I,p+=f*z,H+=f*w,v+=f*j,M+=f*B,A+=f*m,l+=f*Q,c+=f*Z,t+=f*$,d+=f*G,f=e[9],O+=f*i,F+=f*S,E+=f*T,K+=f*U,_+=f*g,k+=f*h,p+=f*I,H+=f*z,v+=f*w,M+=f*j,A+=f*B,l+=f*m,c+=f*Q,t+=f*Z,d+=f*$,b+=f*G,f=e[10],F+=f*i,E+=f*S,K+=f*T,_+=f*U,k+=f*g,p+=f*h,H+=f*I,v+=f*z,M+=f*w,A+=f*j,l+=f*B,c+=f*m,t+=f*Q,d+=f*Z,b+=f*$,o+=f*G,f=e[11],E+=f*i,K+=f*S,_+=f*T,k+=f*U,p+=f*g,H+=f*h,v+=f*I,M+=f*z,A+=f*w,l+=f*j,c+=f*B,t+=f*m,d+=f*Q,b+=f*Z,o+=f*$,n+=f*G,f=e[12],K+=f*i,_+=f*S,k+=f*T,p+=f*U,H+=f*g,v+=f*h,M+=f*I,A+=f*z,l+=f*w,c+=f*j,t+=f*B,d+=f*m,b+=f*Q,o+=f*Z,n+=f*$,R+=f*G,f=e[13],_+=f*i,k+=f*S,p+=f*T,H+=f*U,v+=f*g,M+=f*h,A+=f*I,l+=f*z,c+=f*w,t+=f*j,d+=f*B,b+=f*m,o+=f*Q,n+=f*Z,R+=f*$,L+=f*G,f=e[14],k+=f*i,p+=f*S,H+=f*T,v+=f*U,M+=f*g,A+=f*h,l+=f*I,c+=f*z,t+=f*w,d+=f*j,b+=f*B,o+=f*m,n+=f*Q,R+=f*Z,L+=f*$,W+=f*G,f=e[15],p+=f*i,H+=f*S,v+=f*T,M+=f*U,A+=f*g,l+=f*h,c+=f*I,t+=f*z,d+=f*w,b+=f*j,o+=f*B,n+=f*m,R+=f*Q,L+=f*Z,W+=f*$,ff+=f*G,u+=38*H,y+=38*v,P+=38*M,V+=38*A,C+=38*l,D+=38*c,Y+=38*t,X+=38*d,N+=38*b,O+=38*o,F+=38*n,E+=38*R,K+=38*L,_+=38*W,k+=38*ff,x=1,f=u+x+65535,x=Math.floor(f/65536),u=f-x*65536,f=y+x+65535,x=Math.floor(f/65536),y=f-x*65536,f=P+x+65535,x=Math.floor(f/65536),P=f-x*65536,f=V+x+65535,x=Math.floor(f/65536),V=f-x*65536,f=C+x+65535,x=Math.floor(f/65536),C=f-x*65536,f=D+x+65535,x=Math.floor(f/65536),D=f-x*65536,f=Y+x+65535,x=Math.floor(f/65536),Y=f-x*65536,f=X+x+65535,x=Math.floor(f/65536),X=f-x*65536,f=N+x+65535,x=Math.floor(f/65536),N=f-x*65536,f=O+x+65535,x=Math.floor(f/65536),O=f-x*65536,f=F+x+65535,x=Math.floor(f/65536),F=f-x*65536,f=E+x+65535,x=Math.floor(f/65536),E=f-x*65536,f=K+x+65535,x=Math.floor(f/65536),K=f-x*65536,f=_+x+65535,x=Math.floor(f/65536),_=f-x*65536,f=k+x+65535,x=Math.floor(f/65536),k=f-x*65536,f=p+x+65535,x=Math.floor(f/65536),p=f-x*65536,u+=x-1+37*(x-1),x=1,f=u+x+65535,x=Math.floor(f/65536),u=f-x*65536,f=y+x+65535,x=Math.floor(f/65536),y=f-x*65536,f=P+x+65535,x=Math.floor(f/65536),P=f-x*65536,f=V+x+65535,x=Math.floor(f/65536),V=f-x*65536,f=C+x+65535,x=Math.floor(f/65536),C=f-x*65536,f=D+x+65535,x=Math.floor(f/65536),D=f-x*65536,f=Y+x+65535,x=Math.floor(f/65536),Y=f-x*65536,f=X+x+65535,x=Math.floor(f/65536),X=f-x*65536,f=N+x+65535,x=Math.floor(f/65536),N=f-x*65536,f=O+x+65535,x=Math.floor(f/65536),O=f-x*65536,f=F+x+65535,x=Math.floor(f/65536),F=f-x*65536,f=E+x+65535,x=Math.floor(f/65536),E=f-x*65536,f=K+x+65535,x=Math.floor(f/65536),K=f-x*65536,f=_+x+65535,x=Math.floor(f/65536),_=f-x*65536,f=k+x+65535,x=Math.floor(f/65536),k=f-x*65536,f=p+x+65535,x=Math.floor(f/65536),p=f-x*65536,u+=x-1+37*(x-1),a[0]=u,a[1]=y,a[2]=P,a[3]=V,a[4]=C,a[5]=D,a[6]=Y,a[7]=X,a[8]=N,a[9]=O,a[10]=F,a[11]=E,a[12]=K,a[13]=_,a[14]=k,a[15]=p}function hf(a,e){J(a,e,e)}function xf(a,e){for(var r=0;r<16;r++)a[r]=e[r]|0}function cf(a){var e,r,f=1;for(e=0;e<16;e++)r=a[e]+f+65535,f=Math.floor(r/65536),a[e]=r-f*65536;a[0]+=f-1+37*(f-1)}function Mf(a,e,r){for(var f,x=~(r-1),u=0;u<16;u++)f=x&(a[u]^e[u]),a[u]^=f,e[u]^=f}function gf(a,e){var r=s(),f=s(),x,u,y;for(x=0;x<16;x++)f[x]=e[x];for(cf(f),cf(f),cf(f),u=0;u<2;u++){for(r[0]=f[0]-65517,x=1;x<15;x++)r[x]=f[x]-65535-(r[x-1]>>16&1),r[x-1]&=65535;r[15]=f[15]-32767-(r[14]>>16&1),y=r[15]>>16&1,r[14]&=65535,Mf(f,r,1-y)}for(x=0;x<16;x++)a[2*x]=f[x]&255,a[2*x+1]=f[x]>>8}function If(a){var e=q(32);return gf(e,a),e[0]&1}function Sf(a,e){var r=s(),f;for(f=0;f<16;f++)r[f]=e[f];for(f=253;f>=0;f--)hf(r,r),f!==2&&f!==4&&J(r,r,e);for(f=0;f<16;f++)a[f]=r[f]}function Tf(a,e,r){var f=rf(8),x=rf(8),u=q(256),y,P=r;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,x[0]=4089235720,x[1]=2227873595,x[2]=4271175723,x[3]=1595750129,x[4]=2917565137,x[5]=725511199,x[6]=4215389547,x[7]=327033209,lf(f,x,e,r),r%=128,y=0;y<r;y++)u[y]=e[P-r+y];for(u[r]=128,r=256-128*(r<112?1:0),u[r-9]=0,vf(u,r-8,P/536870912|0,P<<3),lf(f,x,u,r),y=0;y<8;y++)vf(a,8*y,f[y],x[y]);return 0}var uf=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function lf(a,e,r,f){for(var x=rf(16),u=rf(16),y,P,V,C,D,Y,X,N,O,F,E,K,_,k,p,H,v,M,A,l,c,t,d,b,o,n,R=a[0],L=a[1],W=a[2],ff=a[3],i=a[4],S=a[5],T=a[6],U=a[7],g=e[0],h=e[1],I=e[2],z=e[3],w=e[4],j=e[5],B=e[6],m=e[7],Q=0;f>=128;){for(A=0;A<16;A++)l=8*A+Q,x[A]=r[l+0]<<24|r[l+1]<<16|r[l+2]<<8|r[l+3],u[A]=r[l+4]<<24|r[l+5]<<16|r[l+6]<<8|r[l+7];for(A=0;A<80;A++)if(y=R,P=L,V=W,C=ff,D=i,Y=S,X=T,N=U,O=g,F=h,E=I,K=z,_=w,k=j,p=B,H=m,c=U,t=m,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=(i>>>14|w<<32-14)^(i>>>18|w<<32-18)^(w>>>41-32|i<<32-(41-32)),t=(w>>>14|i<<32-14)^(w>>>18|i<<32-18)^(i>>>41-32|w<<32-(41-32)),d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,c=i&S^~i&T,t=w&j^~w&B,d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,c=uf[A*2],t=uf[A*2+1],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,c=x[A%16],t=u[A%16],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,v=o&65535|n<<16,M=d&65535|b<<16,c=v,t=M,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=(R>>>28|g<<32-28)^(g>>>34-32|R<<32-(34-32))^(g>>>39-32|R<<32-(39-32)),t=(g>>>28|R<<32-28)^(R>>>34-32|g<<32-(34-32))^(R>>>39-32|g<<32-(39-32)),d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,c=R&L^R&W^L&W,t=g&h^g&I^h&I,d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,N=o&65535|n<<16,H=d&65535|b<<16,c=C,t=K,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=v,t=M,d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,C=o&65535|n<<16,K=d&65535|b<<16,L=y,W=P,ff=V,i=C,S=D,T=Y,U=X,R=N,h=O,I=F,z=E,w=K,j=_,B=k,m=p,g=H,A%16===15)for(l=0;l<16;l++)c=x[l],t=u[l],d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=x[(l+9)%16],t=u[(l+9)%16],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,v=x[(l+1)%16],M=u[(l+1)%16],c=(v>>>1|M<<32-1)^(v>>>8|M<<32-8)^v>>>7,t=(M>>>1|v<<32-1)^(M>>>8|v<<32-8)^(M>>>7|v<<32-7),d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,v=x[(l+14)%16],M=u[(l+14)%16],c=(v>>>19|M<<32-19)^(M>>>61-32|v<<32-(61-32))^v>>>6,t=(M>>>19|v<<32-19)^(v>>>61-32|M<<32-(61-32))^(M>>>6|v<<32-6),d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,x[l]=o&65535|n<<16,u[l]=d&65535|b<<16;c=R,t=g,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[0],t=e[0],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[0]=R=o&65535|n<<16,e[0]=g=d&65535|b<<16,c=L,t=h,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[1],t=e[1],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[1]=L=o&65535|n<<16,e[1]=h=d&65535|b<<16,c=W,t=I,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[2],t=e[2],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[2]=W=o&65535|n<<16,e[2]=I=d&65535|b<<16,c=ff,t=z,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[3],t=e[3],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[3]=ff=o&65535|n<<16,e[3]=z=d&65535|b<<16,c=i,t=w,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[4],t=e[4],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[4]=i=o&65535|n<<16,e[4]=w=d&65535|b<<16,c=S,t=j,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[5],t=e[5],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[5]=S=o&65535|n<<16,e[5]=j=d&65535|b<<16,c=T,t=B,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[6],t=e[6],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[6]=T=o&65535|n<<16,e[6]=B=d&65535|b<<16,c=U,t=m,d=t&65535,b=t>>>16,o=c&65535,n=c>>>16,c=a[7],t=e[7],d+=t&65535,b+=t>>>16,o+=c&65535,n+=c>>>16,b+=d>>>16,o+=b>>>16,n+=o>>>16,a[7]=U=o&65535|n<<16,e[7]=m=d&65535|b<<16,Q+=128,f-=128}return f}function vf(a,e,r,f){a[e]=r>>24&255,a[e+1]=r>>16&255,a[e+2]=r>>8&255,a[e+3]=r&255,a[e+4]=f>>24&255,a[e+5]=f>>16&255,a[e+6]=f>>8&255,a[e+7]=f&255}function Uf(){var a=q(32),e=q(64);return Bf(a,e,!1),{publicKey:a,secretKey:e}}function jf(a){if(Kf(a),a.length!==64)throw new Error("bad secret key size");for(var e=q(32),r=0;r<e.length;r++)e[r]=a[32+r];return{publicKey:e,secretKey:q(a)}}function Bf(a,e,r){var f=q(64),x=[s(),s(),s(),s()],u;for(r||kf(e,32),Tf(f,e,32),f[0]&=248,f[31]&=127,f[31]|=64,mf(x,f),zf(a,x),u=0;u<32;u++)e[u+32]=a[u];return 0}function mf(a,e){var r=[s(),s(),s(),s()];xf(r[0],df),xf(r[1],nf),xf(r[2],tf),J(r[3],df,nf),Ef(a,r,e)}function Ef(a,e,r){var f,x;for(xf(a[0],of),xf(a[1],tf),xf(a[2],tf),xf(a[3],of),x=255;x>=0;--x)f=r[x/8|0]>>(x&7)&1,yf(a,e,f),sf(e,a),sf(a,a),yf(a,e,f)}function zf(a,e){var r=s(),f=s(),x=s();Sf(x,e[2]),J(r,e[0],x),J(f,e[1],x),gf(a,f),a[31]^=If(r)<<7}function sf(a,e){var r=s(),f=s(),x=s(),u=s(),y=s(),P=s(),V=s(),C=s(),D=s();ef(r,a[1],a[0]),ef(D,e[1],e[0]),J(r,r,D),af(f,a[0],a[1]),af(D,e[0],e[1]),J(f,f,D),J(x,a[3],e[3]),J(x,x,_f),J(u,a[2],e[2]),af(u,u,u),ef(y,f,r),ef(P,u,x),af(V,u,x),af(C,f,r),J(a[0],y,P),J(a[1],C,V),J(a[2],V,P),J(a[3],y,C)}function yf(a,e,r){for(var f=0;f<4;f++)Mf(a[f],e[f],r)}function wf(a){return[...a].map(e=>`0${e.toString(16).toUpperCase()}`.slice(-2)).join("")}function Pf(a){let e=0;const r=new Uint8Array(Math.ceil(a.length/2));for(;e<a.length;){const f=a.slice(e,e+2);r[e/2]=parseInt(f,16),e+=2}return r}function Cf(){const{publicKey:a,secretKey:e}=Uf();return[a,e].map(r=>wf(r)).join("-")}function Df(a){if(typeof a!="string"||a.length!==(64+32)*2+1)return!1;const[e,r]=a.split("-"),f=Pf(r);return wf(jf(f).publicKey)===e}export{Cf as c,Df as v};
